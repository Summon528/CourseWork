<!DOCTYPE html>

<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="mobile-web-app-capable" content="yes">
    <title>
        Intro. to ML HW#2 - Decision Tree &amp; Random Forest - HackMD
    </title>
    <link rel="icon" type="image/png" href="https://hackmd.io/favicon.png">
    <link rel="apple-touch-icon" href="https://hackmd.io/apple-touch-icon.png">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css" integrity="sha256-3iu9jgsy9TpTwXKb7bNQzqWekRX7pPK+2OLj3R922fo=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/octicons/3.5.0/octicons.min.css" integrity="sha256-QiWfLIsCT02Sdwkogf6YMiQlj4NE84MKkzEMkZnMGdg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/themes/prism.min.css" integrity="sha256-vtR0hSWRc3Tb26iuN2oZHt3KRUomwTufNIf5/4oeCyg=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/emojify.js/1.1.0/css/basic/emojify.min.css" integrity="sha256-UOrvMOsSDSrW6szVLe8ZDZezBxh5IoIfgTwdNDgTjiU=" crossorigin="anonymous" />
    <style>
        @charset "UTF-8";@import url(https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i|Source+Code+Pro:300,400,500|Source+Sans+Pro:300,300i,400,400i,600,600i|Source+Serif+Pro&subset=latin-ext);.hljs{display:block;background:#fff;padding:.5em;color:#333;overflow-x:auto}.hljs-comment,.hljs-meta{color:#969896}.hljs-emphasis,.hljs-quote,.hljs-string,.hljs-strong,.hljs-template-variable,.hljs-variable{color:#df5000}.hljs-keyword,.hljs-selector-tag,.hljs-type{color:#a71d5d}.hljs-attribute,.hljs-bullet,.hljs-literal,.hljs-number,.hljs-symbol{color:#0086b3}.hljs-built_in,.hljs-builtin-name{color:#005cc5}.hljs-name,.hljs-section{color:#63a35c}.hljs-tag{color:#333}.hljs-attr,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-id,.hljs-selector-pseudo,.hljs-title{color:#795da3}.hljs-addition{color:#55a532;background-color:#eaffea}.hljs-deletion{color:#bd2c00;background-color:#ffecec}.hljs-link{text-decoration:underline}.markdown-body{font-size:16px;line-height:1.5;word-wrap:break-word}.markdown-body:after,.markdown-body:before{display:table;content:""}.markdown-body:after{clear:both}.markdown-body>:first-child{margin-top:0!important}.markdown-body>:last-child{margin-bottom:0!important}.markdown-body a:not([href]){color:inherit;text-decoration:none}.markdown-body .absent{color:#c00}.markdown-body .anchor{float:left;padding-right:4px;margin-left:-20px;line-height:1}.markdown-body .anchor:focus{outline:none}.markdown-body blockquote,.markdown-body dl,.markdown-body ol,.markdown-body p,.markdown-body pre,.markdown-body table,.markdown-body ul{margin-top:0;margin-bottom:16px}.markdown-body hr{height:.25em;padding:0;margin:24px 0;background-color:#e7e7e7;border:0}.markdown-body blockquote{font-size:16px;padding:0 1em;color:#777;border-left:.25em solid #ddd}.markdown-body blockquote>:first-child{margin-top:0}.markdown-body blockquote>:last-child{margin-bottom:0}.markdown-body kbd,.popover kbd{display:inline-block;padding:3px 5px;font-size:11px;line-height:10px;color:#555;vertical-align:middle;background-color:#fcfcfc;border:1px solid #ccc;border-bottom-color:#bbb;border-radius:3px;box-shadow:inset 0 -1px 0 #bbb}.markdown-body .loweralpha{list-style-type:lower-alpha}.markdown-body h1,.markdown-body h2,.markdown-body h3,.markdown-body h4,.markdown-body h5,.markdown-body h6{margin-top:24px;margin-bottom:16px;font-weight:600;line-height:1.25}.markdown-body h1 .octicon-link,.markdown-body h2 .octicon-link,.markdown-body h3 .octicon-link,.markdown-body h4 .octicon-link,.markdown-body h5 .octicon-link,.markdown-body h6 .octicon-link{color:#000;vertical-align:middle;visibility:hidden}.markdown-body h1:hover .anchor,.markdown-body h2:hover .anchor,.markdown-body h3:hover .anchor,.markdown-body h4:hover .anchor,.markdown-body h5:hover .anchor,.markdown-body h6:hover .anchor{text-decoration:none}.markdown-body h1:hover .anchor .octicon-link,.markdown-body h2:hover .anchor .octicon-link,.markdown-body h3:hover .anchor .octicon-link,.markdown-body h4:hover .anchor .octicon-link,.markdown-body h5:hover .anchor .octicon-link,.markdown-body h6:hover .anchor .octicon-link{visibility:visible}.markdown-body h1 code,.markdown-body h1 tt,.markdown-body h2 code,.markdown-body h2 tt,.markdown-body h3 code,.markdown-body h3 tt,.markdown-body h4 code,.markdown-body h4 tt,.markdown-body h5 code,.markdown-body h5 tt,.markdown-body h6 code,.markdown-body h6 tt{font-size:inherit}.markdown-body h1{font-size:2em}.markdown-body h1,.markdown-body h2{padding-bottom:.3em;border-bottom:1px solid #eee}.markdown-body h2{font-size:1.5em}.markdown-body h3{font-size:1.25em}.markdown-body h4{font-size:1em}.markdown-body h5{font-size:.875em}.markdown-body h6{font-size:.85em;color:#777}.markdown-body ol,.markdown-body ul{padding-left:2em}.markdown-body ol.no-list,.markdown-body ul.no-list{padding:0;list-style-type:none}.markdown-body ol ol,.markdown-body ol ul,.markdown-body ul ol,.markdown-body ul ul{margin-top:0;margin-bottom:0}.markdown-body li>p{margin-top:16px}.markdown-body li+li{margin-top:.25em}.markdown-body dl{padding:0}.markdown-body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}.markdown-body dl dd{padding:0 16px;margin-bottom:16px}.markdown-body table{display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}.markdown-body table th{font-weight:700}.markdown-body table td,.markdown-body table th{padding:6px 13px;border:1px solid #ddd}.markdown-body table tr{background-color:#fff;border-top:1px solid #ccc}.markdown-body table tr:nth-child(2n){background-color:#f8f8f8}.markdown-body img{max-width:100%;box-sizing:content-box;background-color:#fff}.markdown-body img[align=right]{padding-left:20px}.markdown-body img[align=left]{padding-right:20px}.markdown-body .emoji{max-width:none;vertical-align:text-top;background-color:transparent}.markdown-body span.frame{display:block;overflow:hidden}.markdown-body span.frame>span{display:block;float:left;width:auto;padding:7px;margin:13px 0 0;overflow:hidden;border:1px solid #ddd}.markdown-body span.frame span img{display:block;float:left}.markdown-body span.frame span span{display:block;padding:5px 0 0;clear:both;color:#333}.markdown-body span.align-center{display:block;overflow:hidden;clear:both}.markdown-body span.align-center>span{display:block;margin:13px auto 0;overflow:hidden;text-align:center}.markdown-body span.align-center span img{margin:0 auto;text-align:center}.markdown-body span.align-right{display:block;overflow:hidden;clear:both}.markdown-body span.align-right>span{display:block;margin:13px 0 0;overflow:hidden;text-align:right}.markdown-body span.align-right span img{margin:0;text-align:right}.markdown-body span.float-left{display:block;float:left;margin-right:13px;overflow:hidden}.markdown-body span.float-left span{margin:13px 0 0}.markdown-body span.float-right{display:block;float:right;margin-left:13px;overflow:hidden}.markdown-body span.float-right>span{display:block;margin:13px auto 0;overflow:hidden;text-align:right}.markdown-body code,.markdown-body tt{padding:0;padding-top:.2em;padding-bottom:.2em;margin:0;font-size:85%;background-color:rgba(0,0,0,.04);border-radius:3px}.markdown-body code:after,.markdown-body code:before,.markdown-body tt:after,.markdown-body tt:before{letter-spacing:-.2em;content:"\00a0"}.markdown-body code br,.markdown-body tt br{display:none}.markdown-body del code{text-decoration:inherit}.markdown-body pre{word-wrap:normal}.markdown-body pre>code{padding:0;margin:0;font-size:100%;word-break:normal;white-space:pre;background:transparent;border:0}.markdown-body .highlight{margin-bottom:16px}.markdown-body .highlight pre{margin-bottom:0;word-break:normal}.markdown-body .highlight pre,.markdown-body pre{padding:16px;overflow:auto;font-size:85%;line-height:1.45;background-color:#f7f7f7;border-radius:3px}.markdown-body pre code,.markdown-body pre tt{display:inline;max-width:auto;padding:0;margin:0;overflow:visible;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}.markdown-body pre code:after,.markdown-body pre code:before,.markdown-body pre tt:after,.markdown-body pre tt:before{content:normal}.markdown-body .csv-data td,.markdown-body .csv-data th{padding:5px;overflow:hidden;font-size:12px;line-height:1;text-align:left;white-space:nowrap}.markdown-body .csv-data .blob-line-num{padding:10px 8px 9px;text-align:right;background:#fff;border:0}.markdown-body .csv-data tr{border-top:0}.markdown-body .csv-data th{font-weight:700;background:#f8f8f8;border-top:0}.news .alert .markdown-body blockquote{padding:0 0 0 40px;border:0 none}.activity-tab .news .alert .commits,.activity-tab .news .markdown-body blockquote{padding-left:0}.task-list-item{list-style-type:none}.task-list-item label{font-weight:400}.task-list-item.enabled label{cursor:pointer}.task-list-item+.task-list-item{margin-top:3px}.task-list-item-checkbox{float:left;margin:.31em 0 .2em -1.3em!important;vertical-align:middle;cursor:default!important}.markdown-body{padding-top:40px;padding-bottom:40px;max-width:758px;overflow:visible!important}.markdown-body .emoji{vertical-align:top}.markdown-body pre{border:inherit!important}.markdown-body code{color:inherit!important}.markdown-body pre code .wrapper{display:-moz-inline-flex;display:-ms-inline-flex;display:-o-inline-flex;display:inline-flex}.markdown-body pre code .gutter{float:left;overflow:hidden;-webkit-user-select:none;user-select:none}.markdown-body pre code .gutter.linenumber{text-align:right;position:relative;display:inline-block;cursor:default;z-index:4;padding:0 8px 0 0;min-width:20px;box-sizing:content-box;color:#afafaf!important;border-right:3px solid #6ce26c!important}.markdown-body pre code .gutter.linenumber>span:before{content:attr(data-linenumber)}.markdown-body pre code .code{float:left;margin:0 0 0 16px}.markdown-body .gist .line-numbers{border-left:none;border-top:none;border-bottom:none}.markdown-body .gist .line-data{border:none}.markdown-body .gist table{border-spacing:0;border-collapse:inherit!important}.markdown-body code[data-gist-id]{background:none;padding:0}.markdown-body code[data-gist-id]:after,.markdown-body code[data-gist-id]:before{content:""}.markdown-body code[data-gist-id] .blob-num{border:unset}.markdown-body code[data-gist-id] table{overflow:unset;margin-bottom:unset}.markdown-body code[data-gist-id] table tr{background:unset}.markdown-body[dir=rtl] pre{direction:ltr}.markdown-body[dir=rtl] code{direction:ltr;unicode-bidi:embed}.markdown-body .alert>p{margin-bottom:0}.markdown-body pre.abc,.markdown-body pre.flow-chart,.markdown-body pre.graphviz,.markdown-body pre.mermaid,.markdown-body pre.sequence-diagram{text-align:center;background-color:inherit;border-radius:0;white-space:inherit}.markdown-body pre.abc>code,.markdown-body pre.flow-chart>code,.markdown-body pre.graphviz>code,.markdown-body pre.mermaid>code,.markdown-body pre.sequence-diagram>code{text-align:left}.markdown-body pre.abc>svg,.markdown-body pre.flow-chart>svg,.markdown-body pre.graphviz>svg,.markdown-body pre.mermaid>svg,.markdown-body pre.sequence-diagram>svg{max-width:100%;height:100%}.markdown-body pre>code.wrap{white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word}.markdown-body .alert>p,.markdown-body .alert>ul{margin-bottom:0}.markdown-body summary{display:list-item}.markdown-body summary:focus{outline:none}.markdown-body details summary{cursor:pointer}.markdown-body details:not([open])>:not(summary){display:none}.markdown-body figure{margin:1em 40px}.markdown-body .mark,.markdown-body mark{background-color:#fff1a7}.vimeo,.youtube{cursor:pointer;display:table;text-align:center;background-position:50%;background-repeat:no-repeat;background-size:contain;background-color:#000;overflow:hidden}.vimeo,.youtube{position:relative;width:100%}.youtube{padding-bottom:56.25%}.vimeo img{width:100%;object-fit:contain;z-index:0}.youtube img{object-fit:cover;z-index:0}.vimeo iframe,.youtube iframe,.youtube img{width:100%;height:100%;position:absolute;top:0;left:0}.vimeo iframe,.youtube iframe{vertical-align:middle;z-index:1}.vimeo .icon,.youtube .icon{position:absolute;height:auto;width:auto;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;opacity:.3;transition:opacity .2s;z-index:0}.vimeo:hover .icon,.youtube:hover .icon{opacity:.6;transition:opacity .2s}.slideshare .inner,.speakerdeck .inner{position:relative;width:100%}.slideshare .inner iframe,.speakerdeck .inner iframe{position:absolute;top:0;bottom:0;left:0;right:0;width:100%;height:100%}.MJX_Assistive_MathML{display:none}.ui-infobar{position:relative;z-index:2;max-width:760px;margin:25px auto -25px;padding:0 15px;color:#777}.toc .invisable-node{list-style-type:none}.ui-toc{position:fixed;bottom:20px;z-index:998}.ui-toc-label{opacity:.3;background-color:#ccc;border:none;transition:opacity .2s}.ui-toc .open .ui-toc-label{opacity:1;color:#fff;transition:opacity .2s}.ui-toc-label:focus{opacity:.3;background-color:#ccc;color:#000}.ui-toc-label:hover{opacity:1;background-color:#ccc;transition:opacity .2s}.ui-toc-dropdown{margin-top:23px;margin-bottom:20px;padding-left:10px;padding-right:10px;max-width:45vw;width:25vw;max-height:70vh;overflow:auto;text-align:inherit}.ui-toc-dropdown>.toc{max-height:calc(70vh - 100px);overflow:auto}.ui-toc-dropdown[dir=rtl] .nav{padding-right:0;letter-spacing:.0029em}.ui-toc-dropdown a{overflow:hidden;text-overflow:ellipsis;white-space:pre}.ui-toc-dropdown .nav>li>a{display:block;padding:4px 20px;font-size:13px;font-weight:500;color:#767676}.ui-toc-dropdown .nav>li:first-child:last-child > ul,.ui-toc-dropdown .toc.expand ul{display:block}.ui-toc-dropdown .nav>li>a:focus,.ui-toc-dropdown .nav>li>a:hover{padding-left:19px;color:#000;text-decoration:none;background-color:transparent;border-left:1px solid #000}.ui-toc-dropdown[dir=rtl] .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav>li>a:hover{padding-right:19px;border-left:none;border-right:1px solid #000}.ui-toc-dropdown .nav>.active:focus>a,.ui-toc-dropdown .nav>.active:hover>a,.ui-toc-dropdown .nav>.active>a{padding-left:18px;font-weight:700;color:#000;background-color:transparent;border-left:2px solid #000}.ui-toc-dropdown[dir=rtl] .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav>.active>a{padding-right:18px;border-left:none;border-right:2px solid #000}.ui-toc-dropdown .nav .nav{display:none;padding-bottom:10px}.ui-toc-dropdown .nav>.active>ul{display:block}.ui-toc-dropdown .nav .nav>li>a{padding-top:1px;padding-bottom:1px;padding-left:30px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a{padding-right:30px}.ui-toc-dropdown .nav .nav>li>ul>li>a{padding-top:1px;padding-bottom:1px;padding-left:40px;font-size:12px;font-weight:400}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a{padding-right:40px}.ui-toc-dropdown .nav .nav>li>a:focus,.ui-toc-dropdown .nav .nav>li>a:hover{padding-left:29px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>a:hover{padding-right:29px}.ui-toc-dropdown .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown .nav .nav>li>ul>li>a:hover{padding-left:39px}.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:focus,.ui-toc-dropdown[dir=rtl] .nav .nav>li>ul>li>a:hover{padding-right:39px}.ui-toc-dropdown .nav .nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>a{padding-left:28px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>a{padding-right:28px}.ui-toc-dropdown .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown .nav .nav>.active>.nav>.active>a{padding-left:38px;font-weight:500}.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:focus>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active:hover>a,.ui-toc-dropdown[dir=rtl] .nav .nav>.active>.nav>.active>a{padding-right:38px}.markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,sans-serif}html[lang^=ja] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] .markdown-body{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html .markdown-body[lang^=ja]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html .markdown-body[lang=zh-tw]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html .markdown-body[lang=zh-cn]{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica Neue,Helvetica,Roboto,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}html[lang^=ja] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html[lang=zh-tw] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html[lang=zh-cn] .ui-toc-dropdown{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}html .ui-toc-dropdown[lang^=ja]{font-family:Source Sans Pro,Helvetica,Arial,Meiryo UI,MS PGothic,ＭＳ\ Ｐゴシック,sans-serif}html .ui-toc-dropdown[lang=zh-tw]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft JhengHei UI,微軟正黑UI,sans-serif}html .ui-toc-dropdown[lang=zh-cn]{font-family:Source Sans Pro,Helvetica,Arial,Microsoft YaHei UI,微软雅黑UI,sans-serif}.ui-affix-toc{position:fixed;top:0;max-width:15vw;max-height:70vh;overflow:auto}.back-to-top,.expand-toggle,.go-to-bottom{display:block;padding:4px 10px;margin-top:10px;margin-left:10px;font-size:12px;font-weight:500;color:#999}.back-to-top:focus,.back-to-top:hover,.expand-toggle:focus,.expand-toggle:hover,.go-to-bottom:focus,.go-to-bottom:hover{color:#563d7c;text-decoration:none}.back-to-top,.go-to-bottom{margin-top:0}.ui-user-icon{width:20px;height:20px;display:block;border-radius:3px;margin-top:2px;margin-bottom:2px;margin-right:5px;background-position:50%;background-repeat:no-repeat;background-size:cover}.ui-user-icon.small{width:18px;height:18px;display:inline-block;vertical-align:middle;margin:0 0 .2em}.ui-infobar>small>span{line-height:22px}.ui-infobar>small .dropdown{display:inline-block}.ui-infobar>small .dropdown a:focus,.ui-infobar>small .dropdown a:hover{text-decoration:none}.ui-published-note{color:#337ab7}.ui-published-note .fa{font-size:20px;vertical-align:top}.unselectable{-webkit-user-select:none;-o-user-select:none;user-select:none}@media print{blockquote,div,img,pre,table{page-break-inside:avoid!important}a[href]:after{font-size:12px!important}}.markdown-body.slides{position:relative;z-index:1;color:#222}.markdown-body.slides:before{content:"";display:block;position:absolute;top:0;left:0;right:0;bottom:0;z-index:-1;background-color:currentColor;box-shadow:0 0 0 50vw}.markdown-body.slides section[data-markdown]{position:relative;margin-bottom:1.5em;background-color:#fff;text-align:center}.markdown-body.slides section[data-markdown] code{text-align:left}.markdown-body.slides section[data-markdown]:before{content:"";display:block;padding-bottom:56.23%}.markdown-body.slides section[data-markdown]>div:first-child{position:absolute;top:50%;left:1em;right:1em;transform:translateY(-50%);max-height:100%;overflow:hidden}.markdown-body.slides section[data-markdown]>ul{display:inline-block}.markdown-body.slides>section>section+section:after{content:"";position:absolute;top:-1.5em;right:1em;height:1.5em;border:3px solid #777}body{font-smoothing:subpixel-antialiased!important;-webkit-font-smoothing:subpixel-antialiased!important;-moz-osx-font-smoothing:auto!important;text-shadow:0 0 1em transparent,1px 1px 1.2px rgba(0,0,0,.004);-webkit-overflow-scrolling:touch;letter-spacing:.025em}.focus,:focus{outline:none!important}::-moz-focus-inner{border:0!important}body{font-family:Source Sans Pro,Helvetica,Arial,sans-serif}html[lang^=ja] body{font-family:Source Sans Pro,Helvetica,Arial,Hiragino Kaku Gothic Pro,ヒラギノ角ゴ Pro W3,Osaka,Meiryo,メイリオ,MS Gothic,ＭＳ\ ゴシック,sans-serif}html[lang=zh-tw] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang TC,Microsoft JhengHei,微軟正黑,sans-serif}html[lang=zh-cn] body{font-family:Source Sans Pro,Helvetica,Arial,PingFang SC,Microsoft YaHei,微软雅黑,sans-serif}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}abbr[data-original-title],abbr[title]{cursor:help}body.modal-open{overflow-y:auto;padding-right:0!important}
    </style>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" integrity="sha256-3Jy/GbSLrg0o9y5Z5n1uw0qxZECH7C6OQpVBgNFYa0g=" crossorigin="anonymous"></script>
    	<script src="https://cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js" integrity="sha256-g6iAfvZp+nDQ2TdTR/VVKJf3bGro4ub5fvWSWVRi2NE=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/es5-shim/4.5.9/es5-shim.min.js" integrity="sha256-8E4Is26QH0bD52WoQpcB+R/tcWQtpzlCojrybUd7Mxo=" crossorigin="anonymous"></script>
    <![endif]-->
</head>

<body>
    <div id="doc" class="markdown-body container-fluid comment-enabled" data-hard-breaks="true" style="position: relative;"><h1 id="Intro-to-ML-HW2---Decision-Tree-amp-Random-Forest" style=""><a class="anchor hidden-xs" href="#Intro-to-ML-HW2---Decision-Tree-amp-Random-Forest" title="Intro-to-ML-HW2---Decision-Tree-amp-Random-Forest"><span class="octicon octicon-link"></span></a>Intro. to ML HW#2 - Decision Tree &amp; Random Forest</h1><p><strong>Student ID: 061162</strong><br>
<strong>Name: 曾長彥</strong></p><p>See <code>main.cpp</code> for source code, please compile using the <code>make</code> command.<br>
(C++17, pthread, OpenMP support required)</p><h3 id="Predefined-Data-amp-Data-type" style=""><a class="anchor hidden-xs" href="#Predefined-Data-amp-Data-type" title="Predefined-Data-amp-Data-type"><span class="octicon octicon-link"></span></a>Predefined Data &amp; Data type</h3><pre><code class="cpp hljs"><span class="token keyword">using</span> CellType <span class="token operator">=</span> variant<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> string<span class="token operator">&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// A cell is either a string or an int</span>
<span class="token keyword">using</span> RowType <span class="token operator">=</span> vector<span class="token operator">&lt;</span>CellType<span class="token operator">&gt;</span><span class="token punctuation">;</span>       <span class="token comment">// A row is an array of cell</span>
<span class="token keyword">using</span> XType <span class="token operator">=</span> vector<span class="token operator">&lt;</span>RowType<span class="token operator">&gt;</span><span class="token punctuation">;</span>          <span class="token comment">// X is a list of Row</span>
<span class="token keyword">using</span> yType <span class="token operator">=</span> vector<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span>   <span class="token comment">// y is a list of (id, label) pair</span>
<span class="token keyword">using</span> XyType <span class="token operator">=</span> vector<span class="token operator">&lt;</span>pair<span class="token operator">&lt;</span>RowType<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;&gt;</span><span class="token punctuation">;</span>  <span class="token comment">// XyType is a list of</span>
                                            <span class="token comment">// (example, label) pair</span>
</code></pre><h3 id="Data-Input" style=""><a class="anchor hidden-xs" href="#Data-Input" title="Data-Input"><span class="octicon octicon-link"></span></a>Data Input</h3><pre><code class="cpp hljs"><span class="token comment">/**
 * Read and parse example data provided by TA
 *
 * @param file_name
 * @return a vector of example
 */</span>
XType <span class="token function">read_X</span><span class="token punctuation">(</span>string file_name <span class="token operator">=</span> <span class="token string">"X_train.csv"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    csv<span class="token operator">::</span>CSVFormat format<span class="token punctuation">;</span>
    format<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'\t'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    csv<span class="token operator">::</span>CSVReader <span class="token function">reader</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> format<span class="token punctuation">)</span><span class="token punctuation">;</span>
    XType data<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>csv<span class="token operator">::</span>CSVRow<span class="token operator">&amp;</span> row <span class="token operator">:</span> reader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        RowType tmp<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> row<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>row<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">is_int</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                tmp<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>row<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">is_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                tmp<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        data<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><pre><code class="cpp hljs"><span class="token comment">/**
 * Read and parse category data provided by TA
 *
 * @param file_name
 * @return a vector of (id, category) pair
 */</span>
yType <span class="token function">read_y</span><span class="token punctuation">(</span>string file_name <span class="token operator">=</span> <span class="token string">"y_train.csv"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    csv<span class="token operator">::</span>CSVFormat format<span class="token punctuation">;</span>
    format<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'\t'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    csv<span class="token operator">::</span>CSVReader <span class="token function">reader</span><span class="token punctuation">(</span>file_name<span class="token punctuation">,</span> format<span class="token punctuation">)</span><span class="token punctuation">;</span>
    yType data<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>csv<span class="token operator">::</span>CSVRow<span class="token operator">&amp;</span> row <span class="token operator">:</span> reader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        data<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span><span class="token function">make_pair</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>get<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> data<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="Data-Preprocessing" style=""><a class="anchor hidden-xs" href="#Data-Preprocessing" title="Data-Preprocessing"><span class="octicon octicon-link"></span></a>Data Preprocessing</h3><pre><code class="cpp hljs"><span class="token comment">/**
 * Merge X and y, then shuffle the dataset
 *
 * @param X a vector of example (the result from read_X)
 * @param y a vector of (id, label) pair, (the result from read_y)
 * @return a list of shuffled (example, label) pair
 */</span>
XyType <span class="token function">preprocess</span><span class="token punctuation">(</span><span class="token keyword">const</span> XType<span class="token operator">&amp;</span> X<span class="token punctuation">,</span> <span class="token keyword">const</span> yType<span class="token operator">&amp;</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    XyType Xy<span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>X<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> y<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> X<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Xy<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span><span class="token function">make_pair</span><span class="token punctuation">(</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>second<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">shuffle</span><span class="token punctuation">(</span>Xy<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Xy<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">mt19937</span><span class="token punctuation">(</span>RAND_SEED<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> Xy<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="Model-Construction" style=""><a class="anchor hidden-xs" href="#Model-Construction" title="Model-Construction"><span class="octicon octicon-link"></span></a>Model Construction</h3><ul>
<li>Question Class</li>
</ul><pre><code class="cpp hljs"><span class="token keyword">class</span> <span class="token class-name">Question</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span><span class="token operator">:</span>
    <span class="token keyword">int</span> col_idx<span class="token punctuation">;</span>       <span class="token comment">// The index of the target feature</span>
    CellType content<span class="token punctuation">;</span>  <span class="token comment">// The content of this question</span>
    <span class="token keyword">static</span> vector<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span> header_names<span class="token punctuation">;</span>

   <span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">Question</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> col_idx<span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> content<span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">Question</span><span class="token punctuation">(</span><span class="token keyword">int</span> a<span class="token punctuation">,</span> CellType b<span class="token punctuation">)</span> <span class="token operator">:</span> col_idx<span class="token punctuation">{</span>a<span class="token punctuation">}</span><span class="token punctuation">,</span> content<span class="token punctuation">{</span><span class="token function">move</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">populate_header_names</span><span class="token punctuation">(</span>vector<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span> hn<span class="token punctuation">)</span> <span class="token punctuation">{</span> header_names <span class="token operator">=</span> hn<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Describe the question
     */</span>
    <span class="token keyword">void</span> <span class="token function">describe</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>col_idx <span class="token operator">&lt;</span> header_names<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Is "</span> <span class="token operator">&lt;&lt;</span> header_names<span class="token punctuation">[</span>col_idx<span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>content<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                cout <span class="token operator">&lt;&lt;</span> <span class="token string">" &gt;= "</span> <span class="token operator">&lt;&lt;</span> get<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                cout <span class="token operator">&lt;&lt;</span> <span class="token string">" == '"</span> <span class="token operator">&lt;&lt;</span> get<span class="token operator">&lt;</span>string<span class="token operator">&gt;</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token string">"'"</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"? "</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Given the row, will this question answer yes or no
     *
     * If the target feature is a continuous feature, return true if the value
     * is larger or equal to `content`
     *
     * If the target feature is a categorical feature, returm true if the value
     * is eqaul to `content`
     *
     * @param X the result from read_X
     * @param y the result from read_y
     * @return true or false
     */</span>
    <span class="token keyword">bool</span> <span class="token function">match</span><span class="token punctuation">(</span><span class="token keyword">const</span> RowType<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>content<span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> r<span class="token punctuation">[</span>col_idx<span class="token punctuation">]</span> <span class="token operator">&gt;=</span> content<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> r<span class="token punctuation">[</span>col_idx<span class="token punctuation">]</span> <span class="token operator">==</span> content<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><ul>
<li>Node class</li>
</ul><pre><code class="cpp hljs"><span class="token keyword">class</span> <span class="token class-name">Node</span> <span class="token punctuation">{</span>
   <span class="token keyword">public</span><span class="token operator">:</span>
    unique_ptr<span class="token operator">&lt;</span>Node<span class="token operator">&gt;</span> left<span class="token punctuation">,</span> right<span class="token punctuation">;</span>  <span class="token comment">// pointer to the left and right child</span>
    Question q<span class="token punctuation">;</span>                    <span class="token comment">// The question associated to this node</span>
                                   <span class="token comment">//   (only for non-leaf nodes)</span>
    <span class="token keyword">int</span> predict<span class="token punctuation">;</span>                   <span class="token comment">// The prediction of this node</span>
                                   <span class="token comment">//   (only for leaf nodes)</span>
    <span class="token keyword">explicit</span> <span class="token function">Node</span><span class="token punctuation">(</span><span class="token keyword">int</span> predict<span class="token punctuation">)</span>
        <span class="token operator">:</span> left<span class="token punctuation">{</span><span class="token keyword">nullptr</span><span class="token punctuation">}</span><span class="token punctuation">,</span> right<span class="token punctuation">{</span><span class="token keyword">nullptr</span><span class="token punctuation">}</span><span class="token punctuation">,</span> q<span class="token punctuation">{</span><span class="token function">Question</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> predict<span class="token punctuation">{</span>predict<span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
    <span class="token function">Node</span><span class="token punctuation">(</span>unique_ptr<span class="token operator">&lt;</span>Node<span class="token operator">&gt;</span><span class="token operator">&amp;</span> l<span class="token punctuation">,</span> unique_ptr<span class="token operator">&lt;</span>Node<span class="token operator">&gt;</span><span class="token operator">&amp;</span> r<span class="token punctuation">,</span> <span class="token keyword">const</span> Question q<span class="token punctuation">)</span>
        <span class="token operator">:</span> left<span class="token punctuation">{</span><span class="token function">move</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> right<span class="token punctuation">{</span><span class="token function">move</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> q<span class="token punctuation">{</span><span class="token function">move</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span> predict<span class="token punctuation">{</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><ul>
<li>DecisionTree Class</li>
</ul><pre><code class="cpp hljs"><span class="token keyword">class</span> <span class="token class-name">DecisionTree</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span><span class="token operator">:</span>
    unique_ptr<span class="token operator">&lt;</span>Node<span class="token operator">&gt;</span> root<span class="token punctuation">;</span>  <span class="token comment">// a pointer to the root node</span>

    <span class="token comment">/**
     * Count the frequency of each labels
     *
     * @param Xy a vector of (example, label) pair
     *           (example data are not used in this function)
     * @return an unordered_map of (label, count) pair
     */</span>
    <span class="token keyword">static</span> unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span> <span class="token function">count_labels</span><span class="token punctuation">(</span><span class="token keyword">const</span> XyType<span class="token operator">&amp;</span> Xy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span> cnt<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> i <span class="token operator">:</span> Xy<span class="token punctuation">)</span> cnt<span class="token punctuation">[</span>i<span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cnt<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Calculate gini impurity of the given data
     *
     * @param cnt an unordered_map of (label, count) pair
     * @return gini impurity of the given data
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">calc_gini</span><span class="token punctuation">(</span><span class="token keyword">const</span> unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token operator">&amp;</span> cnt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// cacluate the size of the data</span>
        <span class="token keyword">int</span> size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token keyword">const</span><span class="token operator">&amp;</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> val<span class="token punctuation">]</span> <span class="token operator">:</span> cnt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            size <span class="token operator">+</span><span class="token operator">=</span> val<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// cacluate gini impurity</span>
        <span class="token keyword">double</span> result <span class="token operator">=</span> <span class="token number">1.</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token keyword">const</span><span class="token operator">&amp;</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> val<span class="token punctuation">]</span> <span class="token operator">:</span> cnt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">double</span> prob <span class="token operator">=</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token operator">/</span> size<span class="token punctuation">;</span>
            result <span class="token operator">-</span><span class="token operator">=</span> prob <span class="token operator">*</span> prob<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> result<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * For the given question, cacluate the gain with respect to the dataset
     *
     * @param Xy the dataset
     * @param q a qestion
     * @param cur_gini the gini impurity of the dataset
     * @return the gain if we split the dataset by the given question
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">double</span> <span class="token function">calc_gain</span><span class="token punctuation">(</span><span class="token keyword">const</span> XyType<span class="token operator">&amp;</span> Xy<span class="token punctuation">,</span> <span class="token keyword">const</span> Question<span class="token operator">&amp;</span> q<span class="token punctuation">,</span>
                            <span class="token keyword">const</span> <span class="token keyword">double</span> cur_gini<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// find out the distribution of the labels if we split the data</span>
        unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span> cnt_left<span class="token punctuation">,</span> cnt_right<span class="token punctuation">;</span>
        <span class="token keyword">int</span> left_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> right_size <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> i <span class="token operator">:</span> Xy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                cnt_right<span class="token punctuation">[</span>i<span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
                right_size<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                cnt_left<span class="token punctuation">[</span>i<span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
                left_size<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// cacluate gain</span>
        <span class="token keyword">const</span> <span class="token keyword">auto</span> left_gini <span class="token operator">=</span> <span class="token function">calc_gini</span><span class="token punctuation">(</span>cnt_left<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> <span class="token keyword">auto</span> right_gini <span class="token operator">=</span> <span class="token function">calc_gini</span><span class="token punctuation">(</span>cnt_right<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">double</span> left_p <span class="token operator">=</span>
            <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>left_size<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>left_size <span class="token operator">+</span> right_size<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">double</span> gain <span class="token operator">=</span> cur_gini <span class="token operator">-</span> left_p <span class="token operator">*</span> left_gini <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> left_p<span class="token punctuation">)</span> <span class="token operator">*</span> right_gini<span class="token punctuation">;</span>

        <span class="token keyword">return</span> gain<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Actually split the dataset by the given question
     *
     * @param Xy the dataset
     * @param q a qestion
     * @return a pair of (XyType, XyType) where the first element is the set of
     *         data that cannot match the question and the second is those match
     *         the question
     */</span>
    <span class="token keyword">static</span> pair<span class="token operator">&lt;</span>XyType<span class="token punctuation">,</span> XyType<span class="token operator">&gt;</span> <span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">const</span> XyType<span class="token operator">&amp;</span> Xy<span class="token punctuation">,</span> <span class="token keyword">const</span> Question<span class="token operator">&amp;</span> q<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        XyType left<span class="token punctuation">,</span> right<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> i <span class="token operator">:</span> Xy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>q<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                right<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                left<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token punctuation">{</span>left<span class="token punctuation">,</span> right<span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Find the best question and its gain with respect to the dataset
     *
     * @param Xy the dataset
     * @return a pair of (best_gain, best_Question)
     */</span>
    <span class="token keyword">static</span> pair<span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token punctuation">,</span> Question<span class="token operator">&gt;</span> <span class="token function">find_best</span><span class="token punctuation">(</span><span class="token keyword">const</span> XyType<span class="token operator">&amp;</span> Xy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// cacluate current gini</span>
        <span class="token keyword">const</span> <span class="token keyword">auto</span> cur_gini <span class="token operator">=</span> <span class="token function">calc_gini</span><span class="token punctuation">(</span><span class="token function">count_labels</span><span class="token punctuation">(</span>Xy<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Question best_q <span class="token operator">=</span> <span class="token function">Question</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">double</span> max_gain <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>

        <span class="token comment">// for every feature...</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> Xy<span class="token punctuation">.</span><span class="token function">front</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// find all unique value of the feature</span>
            set<span class="token operator">&lt;</span>CellType<span class="token operator">&gt;</span> values<span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> j <span class="token operator">:</span> Xy<span class="token punctuation">)</span> values<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>j<span class="token punctuation">.</span>first<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            vector<span class="token operator">&lt;</span>CellType<span class="token operator">&gt;</span> values_vector<span class="token punctuation">;</span>
            <span class="token comment">// Optimization: if the feature is a continuous feature and have</span>
            <span class="token comment">//               more than 100 unique values, we do not want to try</span>
            <span class="token comment">//               every of them, instead we find the max and mix,</span>
            <span class="token comment">//               let step = (max - min) / 100 and try every step</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>Xy<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>first<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> values<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> min_val <span class="token operator">=</span> get<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">*</span>values<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> max_val <span class="token operator">=</span> get<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">*</span>values<span class="token punctuation">.</span><span class="token function">rbegin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">int</span> step <span class="token operator">=</span> <span class="token punctuation">(</span>max_val <span class="token operator">-</span> min_val<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">100</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> min_val<span class="token punctuation">;</span> j <span class="token operator">&lt;</span> max_val<span class="token punctuation">;</span> j <span class="token operator">+</span><span class="token operator">=</span> step<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    values_vector<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                values_vector<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>max_val<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token function">copy</span><span class="token punctuation">(</span>values<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> values<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                     <span class="token function">back_inserter</span><span class="token punctuation">(</span>values_vector<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

<span class="token comment">// Optimization: process each value of the feature concurrently</span>
<span class="token macro property">#<span class="token directive keyword">pragma</span> omp parallel for</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> values_vector<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">auto</span> q <span class="token operator">=</span> <span class="token function">Question</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> values_vector<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">double</span> gain <span class="token operator">=</span> <span class="token function">calc_gain</span><span class="token punctuation">(</span>Xy<span class="token punctuation">,</span> q<span class="token punctuation">,</span> cur_gini<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token macro property">#<span class="token directive keyword">pragma</span> omp critical</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>gain <span class="token operator">&gt;</span> max_gain<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    best_q <span class="token operator">=</span> q<span class="token punctuation">;</span>
                    max_gain <span class="token operator">=</span> gain<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> <span class="token punctuation">{</span>max_gain<span class="token punctuation">,</span> best_q<span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Recursively build a decision tree
     *
     * @param Xy the dataset
     * @return the root node
     */</span>
    <span class="token keyword">static</span> unique_ptr<span class="token operator">&lt;</span>Node<span class="token operator">&gt;</span> <span class="token function">build_tree</span><span class="token punctuation">(</span><span class="token keyword">const</span> XyType<span class="token operator">&amp;</span> Xy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// find the best question</span>
        <span class="token keyword">const</span> <span class="token keyword">auto</span> <span class="token punctuation">[</span>gain<span class="token punctuation">,</span> question<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">find_best</span><span class="token punctuation">(</span>Xy<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Base case: if the gain is too small, we create a leaf node</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>gain <span class="token operator">&lt;=</span> <span class="token number">0.01</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// find out the dominate label of the dataset</span>
            <span class="token keyword">const</span> <span class="token keyword">auto</span> cnt <span class="token operator">=</span> <span class="token function">count_labels</span><span class="token punctuation">(</span>Xy<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> max_lb <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> max_lb_cnt <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">auto</span> <span class="token keyword">const</span><span class="token operator">&amp;</span> <span class="token punctuation">[</span>key<span class="token punctuation">,</span> val<span class="token punctuation">]</span> <span class="token operator">:</span> cnt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">&gt;</span> max_lb_cnt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    max_lb_cnt <span class="token operator">=</span> val<span class="token punctuation">;</span>
                    max_lb <span class="token operator">=</span> key<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// create a leaf node of the dominate label</span>
            <span class="token keyword">return</span> make_unique<span class="token operator">&lt;</span>Node<span class="token operator">&gt;</span><span class="token punctuation">(</span>max_lb<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">auto</span> <span class="token punctuation">[</span>left<span class="token punctuation">,</span> right<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">split</span><span class="token punctuation">(</span>Xy<span class="token punctuation">,</span> question<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">auto</span> left_node <span class="token operator">=</span> <span class="token function">build_tree</span><span class="token punctuation">(</span>left<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">auto</span> right_node <span class="token operator">=</span> <span class="token function">build_tree</span><span class="token punctuation">(</span>right<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// create an intermediate node</span>
        <span class="token keyword">return</span> make_unique<span class="token operator">&lt;</span>Node<span class="token operator">&gt;</span><span class="token punctuation">(</span>left_node<span class="token punctuation">,</span> right_node<span class="token punctuation">,</span> question<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Recursively walk through the tree and find the predicted value
     *
     * @param r the given example
     * @param n the current node
     * @param describe do we want to describe the question we went through
     * @return the predicted label
     */</span>
    <span class="token keyword">int</span> <span class="token function">_predict</span><span class="token punctuation">(</span><span class="token keyword">const</span> RowType<span class="token operator">&amp;</span> r<span class="token punctuation">,</span> <span class="token keyword">const</span> unique_ptr<span class="token operator">&lt;</span>Node<span class="token operator">&gt;</span><span class="token operator">&amp;</span> n<span class="token punctuation">,</span>
                 <span class="token keyword">bool</span> describe<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token operator">&gt;</span>predict <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>describe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Its label is "</span> <span class="token operator">&lt;&lt;</span> n<span class="token operator">-</span><span class="token operator">&gt;</span>predict <span class="token operator">&lt;&lt;</span> endl <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> n<span class="token operator">-</span><span class="token operator">&gt;</span>predict<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>describe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            n<span class="token operator">-</span><span class="token operator">&gt;</span>q<span class="token punctuation">.</span><span class="token function">describe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>n<span class="token operator">-</span><span class="token operator">&gt;</span>q<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>describe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Yes"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> <span class="token function">_predict</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> n<span class="token operator">-</span><span class="token operator">&gt;</span>right<span class="token punctuation">,</span> describe<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>describe<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            cout <span class="token operator">&lt;&lt;</span> <span class="token string">"No"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token function">_predict</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> n<span class="token operator">-</span><span class="token operator">&gt;</span>left<span class="token punctuation">,</span> describe<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

   <span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token function">DecisionTree</span><span class="token punctuation">(</span><span class="token keyword">const</span> XyType<span class="token operator">&amp;</span> Xy<span class="token punctuation">)</span> <span class="token punctuation">{</span> root <span class="token operator">=</span> <span class="token function">build_tree</span><span class="token punctuation">(</span>Xy<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token keyword">int</span> <span class="token function">predict</span><span class="token punctuation">(</span><span class="token keyword">const</span> RowType<span class="token operator">&amp;</span> r<span class="token punctuation">,</span> <span class="token keyword">bool</span> describe <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">_predict</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> root<span class="token punctuation">,</span> describe<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><ul>
<li>RandomForest Class</li>
</ul><pre><code class="cpp hljs"><span class="token keyword">class</span> <span class="token class-name">RandomForest</span> <span class="token punctuation">{</span>
   <span class="token keyword">private</span><span class="token operator">:</span>
    vector<span class="token operator">&lt;</span>DecisionTree<span class="token operator">&gt;</span> trees<span class="token punctuation">;</span>

   <span class="token keyword">public</span><span class="token operator">:</span>
    <span class="token comment">/**
     * Construct n decision trees, each using 80% of data with different order
     *
     * @param Xy the dataset
     * @param tree_cnt the number of trees to be create
     */</span>
    <span class="token function">RandomForest</span><span class="token punctuation">(</span>XyType Xy<span class="token punctuation">,</span> <span class="token keyword">int</span> tree_cnt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        std<span class="token operator">::</span>mt19937 <span class="token function">g</span><span class="token punctuation">(</span>RAND_SEED<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> tree_cnt<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">shuffle</span><span class="token punctuation">(</span>Xy<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Xy<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> g<span class="token punctuation">)</span><span class="token punctuation">;</span>
            XyType <span class="token function">train_set</span><span class="token punctuation">(</span>Xy<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Xy<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>Xy<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            trees<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span><span class="token function">DecisionTree</span><span class="token punctuation">(</span>train_set<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">int</span> <span class="token function">predict</span><span class="token punctuation">(</span><span class="token keyword">const</span> RowType<span class="token operator">&amp;</span> r<span class="token punctuation">)</span> <span class="token keyword">const</span> <span class="token punctuation">{</span>
        unordered_map<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">&gt;</span> um<span class="token punctuation">;</span>
        <span class="token keyword">int</span> max_lb <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> max_lb_cnt <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> t <span class="token operator">:</span> trees<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> <span class="token keyword">auto</span> ans <span class="token operator">=</span> t<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">;</span>
            um<span class="token punctuation">[</span>ans<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>um<span class="token punctuation">[</span>ans<span class="token punctuation">]</span> <span class="token operator">&gt;</span> max_lb_cnt<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                max_lb <span class="token operator">=</span> ans<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> max_lb<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre><h3 id="Validation" style=""><a class="anchor hidden-xs" href="#Validation" title="Validation"><span class="octicon octicon-link"></span></a>Validation</h3><pre><code class="cpp hljs"><span class="token keyword">void</span> <span class="token function">hold_out</span><span class="token punctuation">(</span><span class="token keyword">const</span> XyType<span class="token operator">&amp;</span> Xy<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token keyword">auto</span> train_size <span class="token operator">=</span> Xy<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">7</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> XyType <span class="token function">train_set</span><span class="token punctuation">(</span>Xy<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Xy<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> train_size<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> XyType <span class="token function">test_set</span><span class="token punctuation">(</span>Xy<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> train_size<span class="token punctuation">,</span> Xy<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token keyword">auto</span> tree <span class="token operator">=</span> <span class="token function">DecisionTree</span><span class="token punctuation">(</span>train_set<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token keyword">auto</span> forest <span class="token operator">=</span> <span class="token function">RandomForest</span><span class="token punctuation">(</span>train_set<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    array<span class="token operator">&lt;</span>array<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">&gt;</span> matrix1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> matrix2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ac1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> ac2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> i <span class="token operator">:</span> test_set<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token keyword">auto</span> r1 <span class="token operator">=</span> tree<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> <span class="token keyword">auto</span> r2 <span class="token operator">=</span> forest<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
        matrix1<span class="token punctuation">[</span>i<span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">[</span>r1<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
        matrix2<span class="token punctuation">[</span>i<span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">[</span>r2<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token punctuation">.</span>second <span class="token operator">==</span> r1<span class="token punctuation">)</span> ac1<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token punctuation">.</span>second <span class="token operator">==</span> r2<span class="token punctuation">)</span> ac2<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Hold out - DecisionTree"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">print_matrix</span><span class="token punctuation">(</span>matrix1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Accuracy: "</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>ac1<span class="token punctuation">)</span> <span class="token operator">/</span> test_set<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl
         <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Hold out - RandomForest"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">print_matrix</span><span class="token punctuation">(</span>matrix2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Accuracy: "</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>ac2<span class="token punctuation">)</span> <span class="token operator">/</span> test_set<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> endl
         <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><pre><code class="cpp hljs"><span class="token keyword">void</span> <span class="token function">k_fold</span><span class="token punctuation">(</span><span class="token keyword">const</span> XyType<span class="token operator">&amp;</span> Xy<span class="token punctuation">,</span> <span class="token keyword">int</span> fold<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    array<span class="token operator">&lt;</span>array<span class="token operator">&lt;</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">&gt;</span> matrix1 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> matrix2 <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> ac1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> ac2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> total_test <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> fold<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        XyType train_set<span class="token punctuation">,</span> test_set<span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">unsigned</span> <span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> Xy<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>j <span class="token operator">%</span> fold <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                test_set<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>Xy<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                train_set<span class="token punctuation">.</span><span class="token function">emplace_back</span><span class="token punctuation">(</span>Xy<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        total_test <span class="token operator">+</span><span class="token operator">=</span> test_set<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> <span class="token keyword">auto</span> tree <span class="token operator">=</span> <span class="token function">DecisionTree</span><span class="token punctuation">(</span>train_set<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> <span class="token keyword">auto</span> forest <span class="token operator">=</span> <span class="token function">RandomForest</span><span class="token punctuation">(</span>train_set<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token keyword">auto</span><span class="token operator">&amp;</span> i <span class="token operator">:</span> test_set<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> <span class="token keyword">auto</span> r1 <span class="token operator">=</span> tree<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">const</span> <span class="token keyword">auto</span> r2 <span class="token operator">=</span> forest<span class="token punctuation">.</span><span class="token function">predict</span><span class="token punctuation">(</span>i<span class="token punctuation">.</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
            matrix1<span class="token punctuation">[</span>i<span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">[</span>r1<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
            matrix2<span class="token punctuation">[</span>i<span class="token punctuation">.</span>second<span class="token punctuation">]</span><span class="token punctuation">[</span>r2<span class="token punctuation">]</span><span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token punctuation">.</span>second <span class="token operator">==</span> r1<span class="token punctuation">)</span> ac1<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token punctuation">.</span>second <span class="token operator">==</span> r2<span class="token punctuation">)</span> ac2<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"K-fold - DecisionTree"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">print_matrix</span><span class="token punctuation">(</span>matrix1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Accuracy: "</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>ac1<span class="token punctuation">)</span> <span class="token operator">/</span> total_test <span class="token operator">&lt;&lt;</span> endl
         <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>

    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"K-fold - RandomForest"</span> <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
    <span class="token function">print_matrix</span><span class="token punctuation">(</span>matrix2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    cout <span class="token operator">&lt;&lt;</span> <span class="token string">"Accuracy: "</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">static_cast</span><span class="token operator">&lt;</span><span class="token keyword">double</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>ac2<span class="token punctuation">)</span> <span class="token operator">/</span> total_test <span class="token operator">&lt;&lt;</span> endl
         <span class="token operator">&lt;&lt;</span> endl<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><h3 id="Results" style=""><a class="anchor hidden-xs" href="#Results" title="Results"><span class="octicon octicon-link"></span></a>Results</h3><ul>
<li><strong>Decision tree - Holdout validation</strong>
<table>
<thead>
<tr>
<th></th>
<th>Predict: 0</th>
<th>Predict: 1</th>
</tr>
</thead>
<tbody>
<tr>
<td>Actual: 0</td>
<td>4982</td>
<td>248</td>
</tr>
<tr>
<td>Actual: 1</td>
<td>759</td>
<td>850</td>
</tr>
</tbody>
</table>
Accuracy:  0.852756<br>
Recall: 0.5283<br>
Precision: 0.7741</li>
<li><strong>Decision tree - K-fold validation</strong>
<table>
<thead>
<tr>
<th></th>
<th>Predict: 0</th>
<th>Predict: 1</th>
</tr>
</thead>
<tbody>
<tr>
<td>Actual: 0</td>
<td>16416</td>
<td>771</td>
</tr>
<tr>
<td>Actual: 1</td>
<td>2703</td>
<td>2904</td>
</tr>
</tbody>
</table>
Accuracy:  0.847591<br>
Recall: 0.5179<br>
Precision: 0.7902</li>
<li><strong>Random forest - Holdout validation</strong>
<table>
<thead>
<tr>
<th></th>
<th>Predict: 0</th>
<th>Predict: 1</th>
</tr>
</thead>
<tbody>
<tr>
<td>Actual: 0</td>
<td>4982</td>
<td>248</td>
</tr>
<tr>
<td>Actual: 1</td>
<td>759</td>
<td>850</td>
</tr>
</tbody>
</table>
Accuracy:  0.850271<br>
Recall: 0.5351<br>
Precision: 0.7573</li>
<li><strong>Decision tree - Holdout validation</strong>
<table>
<thead>
<tr>
<th></th>
<th>Predict: 0</th>
<th>Predict: 1</th>
</tr>
</thead>
<tbody>
<tr>
<td>Actual: 0</td>
<td>16406</td>
<td>781</td>
</tr>
<tr>
<td>Actual: 1</td>
<td>2628</td>
<td>2979</td>
</tr>
</tbody>
</table>
Accuracy:  0.850443<br>
Recall: 0.5313<br>
Precision: 0.7923</li>
<li><strong>Show the prediction and reasoning of 10 samples in the validation set</strong><pre><code>19 Private 60890 HS-grad 9 Never-married Craft-repair Not-in-family White Male 0 0 49 United-States 
Is marital-status == 'Married-civ-spouse'? No
Is capital-gain &gt;= 7430? No
Its label is 0

23 Private 239663 Some-college 10 Never-married Handlers-cleaners Own-child White Male 2597 0 50 United-States 
Is marital-status == 'Married-civ-spouse'? No
Is capital-gain &gt;= 7430? No
Its label is 0

60 Private 532845 1st-4th 2 Married-civ-spouse Craft-repair Husband White Male 0 0 40 Mexico 
Is marital-status == 'Married-civ-spouse'? Yes
Is education-num &gt;= 13? No
Is capital-gain &gt;= 5178? No
Is capital-loss &gt;= 1848? No
Is education-num &gt;= 9? No
Its label is 0

17 Private 345403 10th 6 Never-married Other-service Own-child White Male 0 0 40 United-States 
Is marital-status == 'Married-civ-spouse'? No
Is capital-gain &gt;= 7430? No
Its label is 0

47 Local-gov 178309 Some-college 10 Divorced Prof-specialty Not-in-family White Female 0 0 40 United-States 
Is marital-status == 'Married-civ-spouse'? No
Is capital-gain &gt;= 7430? No
Its label is 0

20 Private 172232 HS-grad 9 Never-married Adm-clerical Own-child White Male 0 0 48 United-States 
Is marital-status == 'Married-civ-spouse'? No
Is capital-gain &gt;= 7430? No
Its label is 0

50 Private 145409 Bachelors 13 Married-civ-spouse Prof-specialty Husband White Male 15024 0 40 United-States 
Is marital-status == 'Married-civ-spouse'? Yes
Is education-num &gt;= 13? Yes
Is capital-gain &gt;= 5178? Yes
Its label is 1

43 Private 45156 Some-college 10 Married-civ-spouse Transport-moving Husband White Male 0 0 60 United-States 
Is marital-status == 'Married-civ-spouse'? Yes
Is education-num &gt;= 13? No
Is capital-gain &gt;= 5178? No
Is capital-loss &gt;= 1848? No
Is education-num &gt;= 9? Yes
Is age &gt;= 36? Yes
Its label is 0

38 Private 372559 Some-college 10 Married-civ-spouse Craft-repair Husband Black Male 0 0 40 United-States 
Is marital-status == 'Married-civ-spouse'? Yes
Is education-num &gt;= 13? No
Is capital-gain &gt;= 5178? No
Is capital-loss &gt;= 1848? No
Is education-num &gt;= 9? Yes
Is age &gt;= 36? Yes
Its label is 0

36 Private 175360 Masters 14 Never-married Adm-clerical Not-in-family White Male 13550 0 50 United-States 
Is marital-status == 'Married-civ-spouse'? No
Is capital-gain &gt;= 7430? Yes
Is age &gt;= 21? Yes
Is occupation == 'Handlers-cleaners'? No
Its label is 1
</code></pre>
</li>
</ul><h3 id="Comparison-amp-Conclusion" style=""><a class="anchor hidden-xs" href="#Comparison-amp-Conclusion" title="Comparison-amp-Conclusion"><span class="octicon octicon-link"></span></a>Comparison &amp; Conclusion</h3><p>In my experiment, while the accuracy is pretty high, the recall rate is low, unfortunately. I think this is because the amount of people with less than 50k income is significantly more than those who make more than 50k. Also, the accuracy of decision tree does not have much difference when comparing to random forest, which is to be expected, since my forest constructor is very naive.</p></div>
    <div class="ui-toc dropup unselectable hidden-print" style="display:none;">
        <div class="pull-right dropdown">
            <a id="tocLabel" class="ui-toc-label btn btn-default" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false" title="Table of content">
                <i class="fa fa-bars"></i>
            </a>
            <ul id="ui-toc" class="ui-toc-dropdown dropdown-menu" aria-labelledby="tocLabel">
                <div class="toc"><ul class="nav">
<li class=""><a href="#Intro-to-ML-HW2---Decision-Tree-amp-Random-Forest" title="Intro. to ML HW#2 - Decision Tree &amp; Random Forest">Intro. to ML HW#2 - Decision Tree &amp; Random Forest</a><ul class="nav">
<li><a href="#Predefined-Data-amp-Data-type" title="Predefined Data &amp; Data type">Predefined Data &amp; Data type</a></li>
<li><a href="#Data-Input" title="Data Input">Data Input</a></li>
<li><a href="#Data-Preprocessing" title="Data Preprocessing">Data Preprocessing</a></li>
<li><a href="#Model-Construction" title="Model Construction">Model Construction</a></li>
<li><a href="#Validation" title="Validation">Validation</a></li>
<li class=""><a href="#Results" title="Results">Results</a></li>
<li><a href="#Comparison-amp-Conclusion" title="Comparison &amp; Conclusion">Comparison &amp; Conclusion</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">全部展開</a><a class="back-to-top" href="#">回到頂部</a><a class="go-to-bottom" href="#">移至底部</a></div>
            </ul>
        </div>
    </div>
    <div id="ui-toc-affix" class="ui-affix-toc ui-toc-dropdown unselectable hidden-print" data-spy="affix" style="top:17px;display:none;" null null>
        <div class="toc"><ul class="nav">
<li class=""><a href="#Intro-to-ML-HW2---Decision-Tree-amp-Random-Forest" title="Intro. to ML HW#2 - Decision Tree &amp; Random Forest">Intro. to ML HW#2 - Decision Tree &amp; Random Forest</a><ul class="nav">
<li><a href="#Predefined-Data-amp-Data-type" title="Predefined Data &amp; Data type">Predefined Data &amp; Data type</a></li>
<li><a href="#Data-Input" title="Data Input">Data Input</a></li>
<li><a href="#Data-Preprocessing" title="Data Preprocessing">Data Preprocessing</a></li>
<li><a href="#Model-Construction" title="Model Construction">Model Construction</a></li>
<li><a href="#Validation" title="Validation">Validation</a></li>
<li class=""><a href="#Results" title="Results">Results</a></li>
<li><a href="#Comparison-amp-Conclusion" title="Comparison &amp; Conclusion">Comparison &amp; Conclusion</a></li>
</ul>
</li>
</ul>
</div><div class="toc-menu"><a class="expand-toggle" href="#">全部展開</a><a class="back-to-top" href="#">回到頂部</a><a class="go-to-bottom" href="#">移至底部</a></div>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.6.0/gist-embed.min.js" integrity="sha256-KyF2D6xPIJUW5sUDSs93vWyZm+1RzIpKCexxElmxl8g=" crossorigin="anonymous" defer></script>
    <script>
        var markdown = $(".markdown-body");
        //smooth all hash trigger scrolling
        function smoothHashScroll() {
            var hashElements = $("a[href^='#']").toArray();
            for (var i = 0; i < hashElements.length; i++) {
                var element = hashElements[i];
                var $element = $(element);
                var hash = element.hash;
                if (hash) {
                    $element.on('click', function (e) {
                        // store hash
                        var hash = this.hash;
                        if ($(hash).length <= 0) return;
                        // prevent default anchor click behavior
                        e.preventDefault();
                        // animate
                        $('body, html').stop(true, true).animate({
                            scrollTop: $(hash).offset().top
                        }, 100, "linear", function () {
                            // when done, add hash to url
                            // (default click behaviour)
                            window.location.hash = hash;
                        });
                    });
                }
            }
        }

        smoothHashScroll();
        var toc = $('.ui-toc');
        var tocAffix = $('.ui-affix-toc');
        var tocDropdown = $('.ui-toc-dropdown');
        //toc
        tocDropdown.click(function (e) {
            e.stopPropagation();
        });

        var enoughForAffixToc = true;

        function generateScrollspy() {
            $(document.body).scrollspy({
                target: ''
            });
            $(document.body).scrollspy('refresh');
            if (enoughForAffixToc) {
                toc.hide();
                tocAffix.show();
            } else {
                tocAffix.hide();
                toc.show();
            }
            $(document.body).scroll();
        }

        function windowResize() {
            //toc right
            var paddingRight = parseFloat(markdown.css('padding-right'));
            var right = ($(window).width() - (markdown.offset().left + markdown.outerWidth() - paddingRight));
            toc.css('right', right + 'px');
            //affix toc left
            var newbool;
            var rightMargin = (markdown.parent().outerWidth() - markdown.outerWidth()) / 2;
            //for ipad or wider device
            if (rightMargin >= 133) {
                newbool = true;
                var affixLeftMargin = (tocAffix.outerWidth() - tocAffix.width()) / 2;
                var left = markdown.offset().left + markdown.outerWidth() - affixLeftMargin;
                tocAffix.css('left', left + 'px');
            } else {
                newbool = false;
            }
            if (newbool != enoughForAffixToc) {
                enoughForAffixToc = newbool;
                generateScrollspy();
            }
        }
        $(window).resize(function () {
            windowResize();
        });
        $(document).ready(function () {
            windowResize();
            generateScrollspy();
        });

        //remove hash
        function removeHash() {
            window.location.hash = '';
        }

        var backtotop = $('.back-to-top');
        var gotobottom = $('.go-to-bottom');

        backtotop.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToTop)
                scrollToTop();
            removeHash();
        });
        gotobottom.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            if (scrollToBottom)
                scrollToBottom();
            removeHash();
        });

        var toggle = $('.expand-toggle');
        var tocExpand = false;

        checkExpandToggle();
        toggle.click(function (e) {
            e.preventDefault();
            e.stopPropagation();
            tocExpand = !tocExpand;
            checkExpandToggle();
        })

        function checkExpandToggle () {
            var toc = $('.ui-toc-dropdown .toc');
            var toggle = $('.expand-toggle');
            if (!tocExpand) {
                toc.removeClass('expand');
                toggle.text('Expand all');
            } else {
                toc.addClass('expand');
                toggle.text('Collapse all');
            }
        }

        function scrollToTop() {
            $('body, html').stop(true, true).animate({
                scrollTop: 0
            }, 100, "linear");
        }

        function scrollToBottom() {
            $('body, html').stop(true, true).animate({
                scrollTop: $(document.body)[0].scrollHeight
            }, 100, "linear");
        }
    </script>
</body>

</html>
